import{a as ae,b as se,c as me,d as ue,e as pe,f as ce,g as fe,h as _e,i as Se,j as ge,k as ve,l as he,m as be,n as Ee,o as Ce,p as xe}from"./chunk-Z2TETTXJ.js";import{Q as le,a as O,b as m,c as R,d as $,f as B,g as G,h as j,i as H,j as P,k as L,l as z,m as J,n as de,o as K}from"./chunk-ALUG67OU.js";import{c as q,d as A,e as V,h as oe}from"./chunk-ZNQ3KTVS.js";import{$ as g,Ab as d,Cb as S,Ea as a,Eb as ie,Fb as re,Ja as I,Oa as w,R as ee,Ra as ne,Ua as p,V as te,Wa as y,a as D,aa as v,eb as s,fb as r,gb as i,hb as c,lb as T,mb as F,ob as N,p as M,qb as f,rb as _}from"./chunk-VNUH3GRI.js";var Q=class e{transform(t,n){return t+" "+n}static \u0275fac=function(n){return new(n||e)};static \u0275pipe=ne({name:"fullname",type:e,pure:!0})};function Te(e,t){e&1&&(r(0,"th",15),d(1," Nombre "),i())}function Fe(e,t){if(e&1&&(r(0,"td",16),d(1),i()),e&2){let n=t.$implicit;a(),S(" ",n.name," ")}}function we(e,t){e&1&&(r(0,"th",15),d(1," Apellido "),i())}function De(e,t){if(e&1&&(r(0,"td",16),d(1),i()),e&2){let n=t.$implicit;a(),S(" ",n.surname," ")}}function Ne(e,t){e&1&&(r(0,"th",15),d(1," Nombre Completo "),i())}function Ae(e,t){if(e&1&&(r(0,"td",16),d(1),ie(2,"fullname"),i()),e&2){let n=t.$implicit;a(),S(" ",re(2,1,n.name,n.surname)," ")}}function Ve(e,t){e&1&&(r(0,"th",15),d(1," Edad "),i())}function Me(e,t){if(e&1&&(r(0,"td",16),d(1),i()),e&2){let n=t.$implicit;a(),S(" ",n.age," ")}}function ke(e,t){e&1&&(r(0,"th",15),d(1," DNI "),i())}function qe(e,t){if(e&1&&(r(0,"td",16),d(1),i()),e&2){let n=t.$implicit;a(),S(" ",n.codigo," ")}}function Oe(e,t){e&1&&(r(0,"th",15),d(1," Curso "),i())}function Re(e,t){if(e&1&&(r(0,"td",16),d(1),i()),e&2){let n=t.$implicit;a(),S(" ",n.title," ")}}function $e(e,t){e&1&&(r(0,"th",15),d(1," Average "),i())}function Be(e,t){if(e&1&&(r(0,"td",16),d(1),i()),e&2){let n=t.$implicit;a(),S(" ",n.avg," ")}}function Ge(e,t){e&1&&(r(0,"th"),d(1," Acciones "),i())}function je(e,t){if(e&1){let n=N();r(0,"tr",17)(1,"button",18),f("click",function(){let l=g(n).$implicit,u=_();return v(u.onEdit(l))}),r(2,"mat-icon"),d(3,"edit"),i()(),r(4,"button",19),f("click",function(){let l=g(n).$implicit,u=_();return v(u.onDelete(l))}),r(5,"mat-icon"),d(6,"delete"),i()()()}}function He(e,t){e&1&&c(0,"tr",20)}function Pe(e,t){e&1&&c(0,"tr",21)}var U=class e{students=[];studentEdit=new y;studentDelete=new y;displayedColumns=["name","surname","fullname","age","dni","average","title","acciones"];constructor(){}ngOnInit(){}onDelete(t){this.studentDelete.emit(t)}onEdit(t){let n;n=D({},t),this.studentEdit.emit(n)}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=w({type:e,selectors:[["app-students-table"]],inputs:{students:"students"},outputs:{studentEdit:"studentEdit",studentDelete:"studentDelete"},decls:27,vars:3,consts:[["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","surname"],["matColumnDef","fullname"],["matColumnDef","age"],["matColumnDef","dni"],["matColumnDef","title"],["matColumnDef","average"],["matColumnDef","acciones"],[4,"matHeaderCellDef"],["class","text-center",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[1,"text-center"],["mat-icon-button","","color","primary",1,"btn","btn-success",3,"click"],["mat-icon-button","","color","warn",1,"btn","btn-danger",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(n,o){n&1&&(r(0,"table",0),T(1,1),p(2,Te,2,0,"th",2)(3,Fe,2,1,"td",3),F(),T(4,4),p(5,we,2,0,"th",2)(6,De,2,1,"td",3),F(),T(7,5),p(8,Ne,2,0,"th",2)(9,Ae,3,4,"td",3),F(),T(10,6),p(11,Ve,2,0,"th",2)(12,Me,2,1,"td",3),F(),T(13,7),p(14,ke,2,0,"th",2)(15,qe,2,1,"td",3),F(),T(16,8),p(17,Oe,2,0,"th",2)(18,Re,2,1,"td",3),F(),T(19,9),p(20,$e,2,0,"th",2)(21,Be,2,1,"td",3),F(),T(22,10),p(23,Ge,2,0,"th",11)(24,je,7,0,"tr",12),F(),p(25,He,1,0,"tr",13)(26,Pe,1,0,"tr",14),i()),n&2&&(s("dataSource",o.students),a(25),s("matHeaderRowDef",o.displayedColumns),a(),s("matRowDefColumns",o.displayedColumns))},dependencies:[ve,ae,me,fe,ue,se,_e,pe,ce,Se,ge,be,he,Q],encapsulation:2})};function ze(e,t){e&1&&(r(0,"div"),d(1," DNI es requerido "),i())}function Je(e,t){e&1&&(r(0,"div"),d(1," DNI es requerido y debe ser mayor 5 caracteres "),i())}function Ke(e,t){e&1&&(r(0,"div"),d(1," Nombre es requerido "),i())}function Qe(e,t){e&1&&(r(0,"div"),d(1," Apellido es requerido "),i())}function Ue(e,t){e&1&&(r(0,"div"),d(1," El email es requerido "),i())}function We(e,t){e&1&&(r(0,"div"),d(1," Edad requerida >= 0 "),i())}function Xe(e,t){e&1&&(r(0,"div"),d(1," Promedio requerido [0,100] "),i())}function Ye(e,t){if(e&1&&(r(0,"option",19),d(1),i()),e&2){let n=t.$implicit;s("value",n.id),a(),S(" ",n.title," ")}}var W=class e{constructor(t){this.fb=t}studentForm;courses=[];studentAdded=new y;noChanges=new y;ngOnInit(){this.studentForm=this.fb.group({id:[0,[m.required,m.min(0)]],codigo:["",[m.required,m.minLength(5)]],name:["",m.required],surname:["",m.required],age:[0,[m.required,m.min(0)]],avg:[0,[m.required,m.min(0),m.max(100)]],email:["",[m.required,m.email]],courseId:[0,[m.required,m.min(1)]],title:[""]})}onSubmit(){this.studentAdded.emit(this.studentForm.value)}onReset(){this.studentForm.reset(),this.noChanges.emit(!0)}static \u0275fac=function(n){return new(n||e)(I(J))};static \u0275cmp=w({type:e,selectors:[["app-add-student"]],inputs:{courses:"courses"},outputs:{studentAdded:"studentAdded",noChanges:"noChanges"},decls:52,vars:11,consts:[[1,"mb-3",3,"ngSubmit","formGroup"],[1,"form-group"],["for","dni"],["type","text","id","id","formControlName","id","placeholder","Ingrese ID","readonly","",1,"form-control"],[4,"ngIf"],["for","codigo"],["type","text","id","codigo","formControlName","codigo","placeholder","Ingrese DNI",1,"form-control"],["for","name"],["type","text","id","name","formControlName","name","placeholder","Ingrese nombre",1,"form-control"],["for","surname"],["type","text","id","surname","formControlName","surname","placeholder","Ingrese apellido",1,"form-control"],["for","email"],["type","text","id","email","formControlName","email","placeholder","Ingrese el email",1,"form-control"],["for","age"],["type","number","id","age","formControlName","age","placeholder","Ingrese la edad",1,"form-control"],["for","average"],["type","number","id","avg","formControlName","avg","placeholder","Ingrese promedio",1,"form-control"],["for","curso"],["formControlName","courseId","id","cursoId",1,"form-select"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"row","text-center","mb-3"],[1,"col","text-center"],["type","submit",1,"btn","btn-success",3,"click","disabled"],["type","button",1,"btn","btn-danger",3,"click"]],template:function(n,o){if(n&1&&(r(0,"h2"),d(1,"A\xF1adir Estudiante"),i(),r(2,"form",0),f("ngSubmit",function(){return o.onSubmit()}),r(3,"div",1)(4,"label",2),d(5,"ID:"),i(),c(6,"input",3),p(7,ze,2,0,"div",4),i(),r(8,"div",1)(9,"label",5),d(10,"DNI:"),i(),c(11,"input",6),p(12,Je,2,0,"div",4),i(),r(13,"div",1)(14,"label",7),d(15,"Nombre:"),i(),c(16,"input",8),p(17,Ke,2,0,"div",4),i(),r(18,"div",1)(19,"label",9),d(20,"Apellido:"),i(),c(21,"input",10),p(22,Qe,2,0,"div",4),i(),r(23,"div",1)(24,"label",11),d(25,"Email:"),i(),c(26,"input",12),p(27,Ue,2,0,"div",4),i(),r(28,"div",1)(29,"label",13),d(30,"Edad:"),i(),c(31,"input",14),p(32,We,2,0,"div",4),i(),r(33,"div",1)(34,"label",15),d(35,"Average:"),i(),c(36,"input",16),p(37,Xe,2,0,"div",4),i(),r(38,"div",1)(39,"label",17),d(40,"Seleccione un curso:"),i(),r(41,"select",18)(42,"option",19),d(43,"-- Seleccionar --"),i(),p(44,Ye,2,2,"option",20),i()()(),r(45,"div",21)(46,"div",22)(47,"button",23),f("click",function(){return o.onSubmit()}),d(48,"Agregar Estudiante"),i()(),r(49,"div",22)(50,"button",24),f("click",function(){return o.onReset()}),d(51,"Salir"),i()()()),n&2){let l,u,h,b,E,C,x;a(2),s("formGroup",o.studentForm),a(5),s("ngIf",((l=o.studentForm.get("id"))==null?null:l.invalid)&&((l=o.studentForm.get("id"))==null?null:l.touched)),a(5),s("ngIf",((u=o.studentForm.get("codigo"))==null?null:u.invalid)&&((u=o.studentForm.get("codigo"))==null?null:u.touched)),a(5),s("ngIf",((h=o.studentForm.get("name"))==null?null:h.invalid)&&((h=o.studentForm.get("name"))==null?null:h.touched)),a(5),s("ngIf",((b=o.studentForm.get("surname"))==null?null:b.invalid)&&((b=o.studentForm.get("surname"))==null?null:b.touched)),a(5),s("ngIf",((E=o.studentForm.get("email"))==null?null:E.invalid)&&((E=o.studentForm.get("email"))==null?null:E.touched)),a(5),s("ngIf",((C=o.studentForm.get("age"))==null?null:C.invalid)&&((C=o.studentForm.get("age"))==null?null:C.touched)),a(5),s("ngIf",((x=o.studentForm.get("avg"))==null?null:x.invalid)&&((x=o.studentForm.get("avg"))==null?null:x.touched)),a(5),s("value",0),a(2),s("ngForOf",o.courses),a(3),s("disabled",o.studentForm.invalid)}},dependencies:[K,B,L,z,O,G,P,R,$,j,H,V,q,A],encapsulation:2})};function Ze(e,t){e&1&&(r(0,"div"),d(1," DNI es requerido "),i())}function et(e,t){e&1&&(r(0,"div"),d(1," DNI es requerido y debe ser mayor 5 caracteres "),i())}function tt(e,t){e&1&&(r(0,"div"),d(1," Nombre es requerido "),i())}function nt(e,t){e&1&&(r(0,"div"),d(1," Apellido es requerido "),i())}function it(e,t){e&1&&(r(0,"div"),d(1," El email es requerido "),i())}function rt(e,t){e&1&&(r(0,"div"),d(1," Edad requerida >= 0 "),i())}function ot(e,t){e&1&&(r(0,"div"),d(1," Promedio requerido [0,100] "),i())}function dt(e,t){if(e&1&&(r(0,"option",19),d(1),i()),e&2){let n=t.$implicit;s("value",n.id),a(),S(" ",n.title," ")}}var X=class e{constructor(t){this.fb=t}studentForm;_studentEdit;student={id:0,codigo:0,name:"",surname:"",email:"",age:0,avg:0,courseId:0,title:""};set studentEdit(t){t&&(this._studentEdit=t,this.student=D({},t),this.studentForm&&this.loadStudentData())}courses=[];studentEdited=new y;noChanges=new y;loadStudentData(){this.studentForm.setValue({id:this.student.id,codigo:this.student.codigo,name:this.student.name,surname:this.student.surname,age:this.student.age,avg:this.student.avg,email:this.student.email,courseId:this.student.courseId,title:this.student.title})}ngOnInit(){this.studentForm=this.fb.group({id:[0,[m.required,m.min(0)]],codigo:["",[m.required,m.minLength(5)]],name:["",m.required],surname:["",m.required],age:[0,[m.required,m.min(0)]],avg:[0,[m.required,m.min(0),m.max(100)]],email:["",[m.required,m.email]],courseId:[0,[m.required,m.min(1)]],title:[""]}),this._studentEdit&&this.loadStudentData()}onSubmit(){this.studentEdited.emit(this.studentForm.value)}onReset(){this.studentForm.reset(),this.noChanges.emit(!0)}static \u0275fac=function(n){return new(n||e)(I(J))};static \u0275cmp=w({type:e,selectors:[["app-edit-student"]],inputs:{studentEdit:"studentEdit",courses:"courses"},outputs:{studentEdited:"studentEdited",noChanges:"noChanges"},decls:52,vars:11,consts:[[1,"mb-3",3,"ngSubmit","formGroup"],[1,"form-group"],["for","dni"],["type","text","id","id","formControlName","id","placeholder","Ingrese ID","readonly","",1,"form-control"],[4,"ngIf"],["for","codigo"],["type","text","id","codigo","formControlName","codigo","placeholder","Ingrese DNI",1,"form-control"],["for","name"],["type","text","id","name","formControlName","name","placeholder","Ingrese nombre",1,"form-control"],["for","surname"],["type","text","id","surname","formControlName","surname","placeholder","Ingrese apellido",1,"form-control"],["for","email"],["type","text","id","email","formControlName","email","placeholder","Ingrese el email",1,"form-control"],["for","age"],["type","number","id","age","formControlName","age","placeholder","Ingrese la edad",1,"form-control"],["for","average"],["type","number","id","avg","formControlName","avg","placeholder","Ingrese promedio",1,"form-control"],["for","curso"],["formControlName","courseId","id","cursoId",1,"form-select"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"row","text-center","mb-3"],[1,"col","text-center"],["type","submit",1,"btn","btn-success",3,"click","disabled"],["type","button",1,"btn","btn-danger",3,"click"]],template:function(n,o){if(n&1&&(r(0,"h2"),d(1,"A\xF1adir Estudiante"),i(),r(2,"form",0),f("ngSubmit",function(){return o.onSubmit()}),r(3,"div",1)(4,"label",2),d(5,"ID:"),i(),c(6,"input",3),p(7,Ze,2,0,"div",4),i(),r(8,"div",1)(9,"label",5),d(10,"DNI:"),i(),c(11,"input",6),p(12,et,2,0,"div",4),i(),r(13,"div",1)(14,"label",7),d(15,"Nombre:"),i(),c(16,"input",8),p(17,tt,2,0,"div",4),i(),r(18,"div",1)(19,"label",9),d(20,"Apellido:"),i(),c(21,"input",10),p(22,nt,2,0,"div",4),i(),r(23,"div",1)(24,"label",11),d(25,"Email:"),i(),c(26,"input",12),p(27,it,2,0,"div",4),i(),r(28,"div",1)(29,"label",13),d(30,"Edad:"),i(),c(31,"input",14),p(32,rt,2,0,"div",4),i(),r(33,"div",1)(34,"label",15),d(35,"Average:"),i(),c(36,"input",16),p(37,ot,2,0,"div",4),i(),r(38,"div",1)(39,"label",17),d(40,"Seleccione un curso:"),i(),r(41,"select",18)(42,"option",19),d(43,"-- Seleccionar --"),i(),p(44,dt,2,2,"option",20),i()()(),r(45,"div",21)(46,"div",22)(47,"button",23),f("click",function(){return o.onSubmit()}),d(48,"Editar Estudiante"),i()(),r(49,"div",22)(50,"button",24),f("click",function(){return o.onReset()}),d(51,"Salir"),i()()()),n&2){let l,u,h,b,E,C,x;a(2),s("formGroup",o.studentForm),a(5),s("ngIf",((l=o.studentForm.get("id"))==null?null:l.invalid)&&((l=o.studentForm.get("id"))==null?null:l.touched)),a(5),s("ngIf",((u=o.studentForm.get("codigo"))==null?null:u.invalid)&&((u=o.studentForm.get("codigo"))==null?null:u.touched)),a(5),s("ngIf",((h=o.studentForm.get("name"))==null?null:h.invalid)&&((h=o.studentForm.get("name"))==null?null:h.touched)),a(5),s("ngIf",((b=o.studentForm.get("surname"))==null?null:b.invalid)&&((b=o.studentForm.get("surname"))==null?null:b.touched)),a(5),s("ngIf",((E=o.studentForm.get("email"))==null?null:E.invalid)&&((E=o.studentForm.get("email"))==null?null:E.touched)),a(5),s("ngIf",((C=o.studentForm.get("age"))==null?null:C.invalid)&&((C=o.studentForm.get("age"))==null?null:C.touched)),a(5),s("ngIf",((x=o.studentForm.get("avg"))==null?null:x.invalid)&&((x=o.studentForm.get("avg"))==null?null:x.touched)),a(5),s("value",0),a(2),s("ngForOf",o.courses),a(3),s("disabled",o.studentForm.invalid)}},dependencies:[K,B,L,z,O,G,P,R,$,j,H,V,q,A],encapsulation:2})};var Y=class e{constructor(t){this.http=t}url="https://curso.sunsetmanager.com/api";loadStudents(){return this.http.get(`${this.url}/student`).pipe(M(t=>t))}addStudent(t){return this.http.post(`${this.url}/student`,t).pipe(M(n=>n))}editStudent(t){return this.http.put(`${this.url}/student`,t).pipe(M(n=>n))}deleteStudent(t){return this.http.delete(`${this.url}/student?id=${t}`).pipe(M(n=>n))}static \u0275fac=function(n){return new(n||e)(te(oe))};static \u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"})};function at(e,t){if(e&1){let n=N();r(0,"app-students-table",10),f("studentDelete",function(l){g(n);let u=_();return v(u.onDelete(l))})("studentEdit",function(l){g(n);let u=_();return v(u.onEdit(l))}),i()}if(e&2){let n=_();s("students",n.students)}}function st(e,t){if(e&1){let n=N();r(0,"app-add-student",11),f("noChanges",function(l){g(n);let u=_();return v(u.noChangeNewSudent(l))})("studentAdded",function(l){g(n);let u=_();return v(u.addStudent(l))}),i()}if(e&2){let n=_();s("courses",n.courses)}}function mt(e,t){if(e&1){let n=N();r(0,"app-edit-student",12),f("noChanges",function(l){g(n);let u=_();return v(u.noChangeNewSudent(l))})("studentEdited",function(l){g(n);let u=_();return v(u.editedStudent(l))}),i()}if(e&2){let n=_();s("courses",n.courses)("studentEdit",n.editStudent)}}var ye=class e{constructor(t,n,o,l){this._servicios=t;this._serviciosC=n;this.dialog=o;this.snackBar=l}courses=[];students=[];editStudent;formVisible=[!0,!1,!1];ngOnInit(){this.loadStudents(),this.loadCourses(),this.formVisible[0]=!0}loadStudents(){this._servicios.loadStudents().subscribe({next:t=>{t.ok.toString()==="true"&&(this.students=t.result,this.students=[...this.students],this.noChangeNewSudent(!0))},error:t=>{this.snackBar.show(t)},complete:()=>{this.students=[...this.students]}})}loadCourses(){this._serviciosC.loadCourses().subscribe(t=>{t.ok.toString()==="true"&&(this.courses=t.result)})}newStudent(){this.formVisible=[!1,!0,!1]}noChangeNewSudent(t){this.formVisible=[t,!1,!1]}addStudent(t){this._servicios.addStudent(t).subscribe({next:n=>{n.ok.toString()==="true"&&this.snackBar.show(n.msg)},error:n=>{this.snackBar.show(n.message)},complete:()=>{this.loadStudents()}})}editedStudent(t){this._servicios.editStudent(t).subscribe({next:n=>{if(n.ok.toString()==="true"){this.snackBar.show(n.msg);let l=this.students.findIndex(u=>u.id===t.id);if(l!==-1){var o=this.courses.find(u=>u.id==t.courseId);t.title=""+o?.title,this.students[l]=D({},t),this.students=[...this.students]}this.noChangeNewSudent(!0)}},error:n=>{this.snackBar.show(n.message)}})}onEdit(t){this.editStudent=t,this.formVisible=[!1,!1,!0]}onDelete(t){this.dialog.open(Ce,{width:"350px",data:{mensaje:"\xBFEst\xE1s seguro de eliminar al estudiante "+t.name+"?"}}).afterClosed().subscribe(o=>{o?this._servicios.deleteStudent(t.id).subscribe(l=>{l.ok.toString()==="true"?(this.students=this.students.filter(u=>u.id!==t.id),this.snackBar.show(l.msg)):this.snackBar.show(l.msg)}):console.log("El usuario cancel\xF3")})}static \u0275fac=function(n){return new(n||e)(I(Y),I(xe),I(Ee),I(le))};static \u0275cmp=w({type:e,selectors:[["app-students"]],decls:14,vars:3,consts:[[1,"container-fluid"],[1,"row"],[1,"row","mt-5"],[1,"d-flex","justify-content-between","align-items-center","p-3","bg-light","rounded","border"],[1,"mb-0"],[1,"btn","btn-primary",3,"click"],[1,"w-100"],[3,"students","studentDelete","studentEdit",4,"ngIf"],[3,"courses","noChanges","studentAdded",4,"ngIf"],[3,"courses","studentEdit","noChanges","studentEdited",4,"ngIf"],[3,"studentDelete","studentEdit","students"],[3,"noChanges","studentAdded","courses"],[3,"noChanges","studentEdited","courses","studentEdit"]],template:function(n,o){n&1&&(r(0,"div",0),c(1,"div",1),r(2,"div",2)(3,"div",3)(4,"h5",4),d(5,"Estudiantes"),i(),r(6,"button",5),f("click",function(){return o.newStudent()}),d(7,"Nuevo"),i()()(),r(8,"div",2)(9,"div",3)(10,"div",6),p(11,at,1,1,"app-students-table",7)(12,st,1,1,"app-add-student",8)(13,mt,1,2,"app-edit-student",9),i()()()()),n&2&&(a(11),s("ngIf",o.formVisible[0]===!0),a(),s("ngIf",o.formVisible[1]),a(),s("ngIf",o.formVisible[2]))},dependencies:[U,de,V,A,W,X],encapsulation:2})};export{ye as Students};
